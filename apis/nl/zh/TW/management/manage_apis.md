---

copyright:
  years: 2017
lastupdated: "2017-04-13"

---


{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}

# 管理 API
{: #manage_apis}

整合 API 以透過 API Management 系統進行管理及監視之後，即可檢視及修改 API 設定。如果您尚未整合 API，則必須完成[從 {{site.data.keyword.openwhisk_short}} 動作建立 API](manage_openwhisk_apis.html) 中的程序來整合 API。 

若要管理 API 的設定，請完成下列步驟：

如果您已建立新的 API，並且已在介面中予以開啟，則可以跳過前三個步驟。

1. 如果尚未顯示 API 的資訊，請透過選取 {{site.data.keyword.openwhisk_short}} 服務儀表板上的動作來選取您要管理的 API。
2. 選取 **API** 標籤（必要的話）。
3. 選取您要管理的 API（必要的話）。建立連線之後，您可以使用下列選項來進行檢視及更新：
    * 摘要
    * 定義
    * 共用
    * API 瀏覽器
4. 選取「公開受管理 API」調節器，以啟動它並公開 API。附註：未公開 API 時，無法設定部分設定。  

## API 設定摘要
{: #overview_api}

「摘要」標籤依預設會在您選取 API 時予以選取，並分成兩個區段：
* 內容 - 在「內容」區段中，您可以檢視下列資訊：
    * 關於 API 的基本資訊
	* 安全原則
	* 比率限制資訊
    * 共用詳細資料
* 「分析及記載」區段 - 在「分析及記載」區段中，您可以檢視下列統計資料：
	* 最後指定時間間隔期間的回應數目及平均回應時間
    * 每分鐘的 API 呼叫數目（圖形格式）
    * 「回應日誌」表格中的最後 100 個回應
	
*回應* 圖形可快速呈現 API 收到的回應數目，以及回應狀態的分解。這可協助您判斷是否收到大多數的錯誤回應。大多數的錯誤回應可能指出您的資料流量高於比率設定中容許的資料流量。將游標移至資訊圖示上方，即可依回應碼查看回應的數值分解。下列是常見的回應碼：
* 200  正常
* 201  Created
* 302  找到
* 304  未修改
* 400  不當要求
* 401  未獲授權
* 403  已禁止
* 500  內部伺服器錯誤
* 503  服務無法使用

「回應日誌」表格包含最後 100 個回應的個別詳細資料。選取直欄標題，即可根據直欄中的項目來排序資訊。使用*搜尋回應* 列，即可搜尋「回應日誌」表格中的特定項目。選取事件，或是在項目旁的選項清單功能表（三個垂直點）選取**檢視詳細資料**，即可取得事件的相關資訊。


## 編輯 API 設定
{: #settings_api}

在**定義**標籤中，您可以更新 API 的基本資訊。此資訊包括文件、名稱及基本 URL。使用「安全及比率限制」區段指定呼叫及間隔限制，以確保每秒、每分鐘或每小時只執行特定的呼叫數量。您也可以要求得進行鑑別才能建立 API 呼叫，以防止不必要的資料使用或收集 API 統計資料。

若要變更 API 的設定，請完成下列步驟：

1. 在 API Management 儀表板中，按一下**定義**標籤。
2. 您可以命名 API 或更新 API 的名稱，以及在「API 資訊」區段中匯入 API 定義。
3. 在「安全及比率限制」區段中，您可以更新下列原則：
    * 需要 API 金鑰 - 指定是否只有在提供正確的 API 金鑰時才能處理 API 呼叫。預設值不需要額外金鑰。
    * 安全方法 - 選取 API 金鑰選項時，指定處理 API 時只需要 API 金鑰，還是同時需要 API 金鑰及 API 密碼。
    * API 金鑰及密碼的位置 - 根據方法的設定，指定如何在呼叫中包括 API 安全資訊。「呼叫名稱」指定如何識別安全資訊。
    * 限制 API 呼叫率 - 設定所指定時間間隔期間容許的 API 呼叫數目，並且可以選擇針對每一個金鑰設定它。請注意，會使用 rate-limiting 方法的 burst-type。平均 API 呼叫率是透過比率中所指定的總時間間隔計算而來。如果間隔期間的 API 呼叫率超出平均 API 呼叫率，則拒絕呼叫的期間最長可達到比率中所指定的時間限制。   
    * OAuth 提供者 - 確定具有正確安全參數的使用者，可以藉由透過提供者（如 Google、Facebook、IBM 及 GitHub）的社交登入認證強制執行 Oauth，而存取 API。
4. 啟用 CORS - 跨原點要求 (CORS) 可啟用來自不同網域的一些有限要求。
5. 按一下**儲存**。

## 共用 API
{: #share_api}

您可以與 {{site.data.keyword.Bluemix_notm}} 組織內外部的其他使用者共用 API。

當您與 {{site.data.keyword.Bluemix_notm}} 組織內外部的其他人共用 API 時，可以建立 API 的金鑰。每一個受管理 API 都支援可建立並指派該 API 的 5 個金鑰。將唯一金鑰傳送給個人或公司，即可追蹤該 API 使用方式的部分統計資料。例如，您可以追蹤該人員或公司的 API 呼叫數目。

您也可以停用金鑰，或限制來自金鑰的呼叫。這在測試、工作負載平衡、換算成貨幣或用於處理部分安全狀況期間十分有用。  

1. 在 API Management 儀表板中，按一下**共用**標籤。
2. 在「在 {{site.data.keyword.Bluemix_notm}} 組織內共用」區域內，如果您要 API 可讓其他人存取您的 {{site.data.keyword.Bluemix_notm}} 組織，請選取**與我的 Bluemix 組織中的所有使用者共用 API**。必須選取此選項，才能產生金鑰。
3. 按一下**建立 API 金鑰**，以建立 API 的唯一金鑰。即會顯示「建立 API 金鑰」對話框。API 金鑰會自動產生。
4. 使用 API 金鑰，透過傳送使用者的唯一金鑰來判斷哪位使用者正在存取 API。閘道可以判斷哪個金鑰（及客戶）正在產生呼叫。
5. 按一下金鑰旁的**功能表**圖示（三個垂直點），以「編輯」或「刪除」該 API 金鑰。

在「在 {{site.data.keyword.Bluemix_notm}} 組織外共用」區段中，您可以與沒有 {{site.data.keyword.Bluemix_notm}} 帳戶的使用者共用 API。這個共用方法提供在「API 瀏覽器」中檢視 API 相關資訊的直接鏈結。API 包含可在「API 瀏覽器」視圖中執行 API 的按鈕。若要要求 API 的鏈結，請完成下列步驟：

1. 在「在 {{site.data.keyword.Bluemix_notm}} 組織外共用」區段內，按一下**建立 API 金鑰**。即會顯示「建立 API 金鑰」對話框。請注意，使用者具有您無法控制的密碼。
2. 提供 API 金鑰的唯一名稱。
3. 選取**建立金鑰**。 
4. 將「API 入口網站鏈結」傳送給沒有 {{site.data.keyword.Bluemix_notm}} 帳戶的客戶。API 金鑰及密碼（如果使用的話）內含在鏈結中，因此，您仍然可以判斷是哪一個金鑰產生鏈結。
  
API 文件鏈結會在 **API 瀏覽器**標籤中開啟 API。

## 使用 API 瀏覽器檢視及測試
{: #explore_api}

選取「API 瀏覽器」標籤，以檢視從 Swagger 文件中產生的 HTML。 

「API 瀏覽器」會顯示適用於 API 的所有 API 動作及文件。您可以從使用者介面來檢視作業及動作、其說明，以及測試 API。您也可以下載 Swagger 文件，以重複使用其內容。

若要測試 API，請完成下列步驟：
1. 依預設，會選取*範例*。這會顯示所選取 API 的程式碼範例。
2. 從所指定語言旁的功能表中選取語言，以變更範例格式（必要的話）。 
3. 選取**試用**。
4. 選取**呼叫作業**。 

即會顯示要求的回應。   
